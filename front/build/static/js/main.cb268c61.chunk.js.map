{"version":3,"sources":["Navbar.tsx","ApiClient.ts","Config.ts","App.tsx","index.tsx"],"names":["Navbar","className","role","aria-label","href","extractData","response","data","graphConfig","App","useState","cycles","graphData","nodes","links","description","show_only_new_cycles","state","setState","useEffect","Axios","get","then","_","s","showOnlyNewCycles","constructGraphDataFromPackages","packages","map","id","name","flatMap","p","uses","source","target","cycleClicked","cycleIndex","cycleId","showCompleteGraphClicked","type","checked","onChange","key","onClick","filter","it","new_cycle","length","undefined","style","border","borderWidth","borderStyle","config","onClickLink","promises","find","from","to","Promise","all","imports","marginLeft","i","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.cb268c61.chunk.js","sourcesContent":["import React from \"react\";\n\nexport function Navbar() {\n    return (\n        <nav className=\"navbar is-primary\" role=\"navigation\" aria-label=\"main navigation\">\n            <div className=\"navbar-brand\">\n                <a className=\"navbar-item\" href=\"/#\">\n                    Cycle-hunter 9000\n                </a>\n            </div>\n        </nav>\n    );\n}","import Axios, {AxiosResponse} from \"axios\";\nimport {CycleList, ImportInfo, Package} from \"./Model\";\n\nfunction extractData<T>(response: AxiosResponse<T>): T {\n    return response.data;\n}\n\nexport function getCycleList(): Promise<CycleList> {\n    return Axios.get<CycleList>(\"/cycles\").then(extractData);\n}\n\nexport function getGraphForCycle(cycleId: number): Promise<Array<Package>> {\n    return Axios.get<Array<Package>>(`/cycle/${cycleId}`).then(extractData);\n}\n\nexport function getImportsFromTo(from: string, to: string): Promise<ImportInfo> {\n    return Axios.get<ImportInfo>(`/imports/${from}/${to}`).then(extractData);\n}\n\nexport function getCompleteGraph(): Promise<Array<Package>> {\n    return Axios.get<Array<Package>>(\"/graph\").then(extractData);\n}\n\n","export const graphConfig = {\n    \"automaticRearrangeAfterDropNode\": true,\n    \"collapsible\": true,\n    \"directed\": true,\n    \"focusAnimationDuration\": 0,\n    \"focusZoom\": 1,\n    \"height\": 800,\n    \"highlightDegree\": 2,\n    \"highlightOpacity\": 1,\n    \"linkHighlightBehavior\": true,\n    \"maxZoom\": 8,\n    \"minZoom\": 0.1,\n    \"nodeHighlightBehavior\": true,\n    \"panAndZoom\": false,\n    \"staticGraph\": false,\n    \"staticGraphWithDragAndDrop\": false,\n    \"width\": 1500,\n    \"d3\": {\n        \"alphaTarget\": 0.05,\n        \"gravity\": -200,\n        \"linkLength\": 300,\n        \"linkStrength\": 1,\n        \"disableLinkForce\": false\n    },\n    \"node\": {\n        \"color\": \"grey\",\n        \"fontColor\": \"black\",\n        \"fontSize\": 15,\n        \"fontWeight\": \"normal\",\n        \"highlightColor\": \"orange\",\n        \"highlightFontSize\": 8,\n        \"highlightFontWeight\": \"normal\",\n        \"highlightStrokeColor\": \"SAME\",\n        \"highlightStrokeWidth\": \"SAME\",\n        \"labelProperty\": \"id\",\n        \"mouseCursor\": \"pointer\",\n        \"opacity\": 1,\n        \"renderLabel\": true,\n        \"size\": 100,\n        \"strokeColor\": \"none\",\n        \"strokeWidth\": 1.5,\n        \"svg\": \"\",\n        \"symbolType\": \"circle\"\n    },\n    \"link\": {\n        \"color\": \"#d3d3d3\",\n        \"fontColor\": \"black\",\n        \"fontSize\": 8,\n        \"fontWeight\": \"normal\",\n        \"highlightColor\": \"black\",\n        \"highlightFontSize\": 8,\n        \"highlightFontWeight\": \"normal\",\n        \"labelProperty\": \"label\",\n        \"mouseCursor\": \"pointer\",\n        \"opacity\": 1,\n        \"renderLabel\": false,\n        \"semanticStrokeWidth\": false,\n        \"strokeWidth\": 2,\n        \"markerHeight\": 3,\n        \"markerWidth\": 3\n    }\n}\n","import React, {useEffect, useState} from 'react';\nimport './App.css';\nimport 'bulma/css/bulma.css'\nimport {Navbar} from \"./Navbar\";\nimport {Graph} from \"react-d3-graph\";\nimport {getCompleteGraph, getCycleList, getGraphForCycle, getImportsFromTo} from \"./ApiClient\";\nimport {CycleList, GraphData, ImportInfo, Package} from \"./Model\";\nimport {graphConfig} from \"./Config\";\n\ninterface State {\n    cycles: CycleList,\n    graphData: GraphData,\n    description: Array<ImportInfo>,\n    show_only_new_cycles: boolean\n}\n\nfunction App() {\n    let [state, setState] = useState<State>({\n        cycles: [],\n        graphData: {nodes: [], links: []},\n        description: [],\n        show_only_new_cycles: false\n    });\n\n    useEffect(() => {\n        getCycleList().then(_ => setState(s => ({...s, cycles: _})))\n    }, [])\n\n    const toggle_show_only_new_cycles = () => {\n        setState(s => ({...s, show_only_new_cycles: !s.show_only_new_cycles}))\n    }\n\n    const onClickLink = (source: string, target: string) => {\n        const pairs = state.graphData.links.find(_ => _.source === target && _.target === source) === undefined\n            ? [[source, target]]\n            : [[target, source], [source, target]];\n        const promises = pairs.map(_ => getImportsFromTo(_[0], _[1]));\n        Promise.all(promises)\n            .then(_ => setState({\n                ...state,\n                description: _.map(it => ({from: it.from, to: it.to, imports: it.imports}))\n            }));\n    };\n\n    const constructGraphDataFromPackages = (packages: Array<Package>): GraphData => {\n        return {\n            nodes: packages.map(_ => ({id: _.name})),\n            links: packages.flatMap(p => p.uses.map(_ => ({source: p.name, target: _})))\n        };\n    }\n\n    const cycleClicked = (cycleIndex: number) => {\n        getGraphForCycle(cycleIndex)\n            .then(constructGraphDataFromPackages)\n            .then(_ => setState({...state, graphData: _}))\n    }\n\n    function cycleList(cycles: CycleList, showOnlyNewCycles: boolean): JSX.Element[] {\n        return cycles\n            .filter(it => showOnlyNewCycles ? it.new_cycle : true)\n            .map((it ) => <a\n                    key={it.id}\n                    href=\"/#\"\n                    className=\"list-item\"\n                    onClick={_ => cycleClicked(it.id)}>\n                    {it.packages.length} item cycle\n                </a>\n            )\n    }\n\n    const showCompleteGraphClicked = () => {\n        getCompleteGraph()\n            .then(constructGraphDataFromPackages)\n            .then(_ => setState({...state, graphData: _}))\n    }\n\n    return (\n        <div className=\"App\">\n            <Navbar/>\n            <div className=\"\">\n                <div className=\"columns is-marginless\">\n                    <div className=\"column is-one-fifth\">\n                        <div className=\"field\">\n                            <input\n                                type=\"checkbox\"\n                                checked={state.show_only_new_cycles}\n                                onChange={_ => toggle_show_only_new_cycles()}\n                            />\n                            <label>Show only new cycles</label>\n                        </div>\n                        <div className=\"list\">\n                            <a\n                                key=\"complete-graph\"\n                                href=\"/#\"\n                                className=\"list-item\"\n                                onClick={_ => showCompleteGraphClicked()}>\n                                Complete dependency graph\n                            </a>\n                            {cycleList(state.cycles, state.show_only_new_cycles)}\n                        </div>\n                    </div>\n                    <div className=\"column\">\n                        {state.graphData.nodes.length === 0\n                            ? undefined\n                            : <div style={{border: \"black\", borderWidth: 1, borderStyle: \"dashed\"}}>\n                                <Graph\n                                    id=\"cycle-graph\"\n                                    data={state.graphData}\n                                    config={graphConfig}\n                                    onClickLink={onClickLink}/>\n                            </div>\n                        }\n                    </div>\n                </div>\n                <div className=\"columns\" style={{marginLeft: \"auto\"}}>\n                    {state.description.map(_ => <div className=\"column\">\n                        <table className=\"table\">\n                            <thead>\n                            <tr>\n                                <th className=\"has-text-centered\">{`${_.to} imports in ${_.from}`}</th>\n                            </tr>\n                            </thead>\n                            <tbody>\n                            {_.imports.map(i => <tr className=\"has-text-left\">{i}</tr>)}\n                            </tbody>\n                        </table>\n                    </div>)}\n                </div>\n            </div>\n        </div>\n    );\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}